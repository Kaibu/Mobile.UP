<ion-header>
  <ion-toolbar>
    <ion-back-button slot="start"></ion-back-button>
    <ion-menu-button slot="end"></ion-menu-button>
    <ion-title>{{ "page.timetable.title" | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content no-padding [ngClass]="modalOpen ? 'modalOpened' : 'modalClosed'">

  <div align="center" *ngIf="isLoading && !noUserRights" padding>
    <ion-spinner></ion-spinner>
  </div>

  <div *ngIf="noUserRights">
    <app-hint-box hintTypeI18nKey="hints.type.hint" hintTextI18nKey="hints.text.grades-notSupported-hint"></app-hint-box>
  </div>

  <span *ngIf="!noUserRights && !isLoading">
      <div align="center">
        <ion-row>
          <ion-col>
            <ion-button [ngClass]="calendarOptions.calendarMode == 'month' ? 'activeCalendarButton' : 'calendarButton'" size="small" (click)="changeCalendarMode('month')">
              {{ "page.timetable.month" | translate }}
            </ion-button>
            <ion-button [ngClass]="calendarOptions.calendarMode == 'week' ? 'activeCalendarButton' : 'calendarButton'" size="small" (click)="changeCalendarMode('week')">
              {{ "page.timetable.week" | translate }}
            </ion-button>
            <ion-button [ngClass]="calendarOptions.calendarMode == 'day' ? 'activeCalendarButton' : 'calendarButton'" size="small" (click)="changeCalendarMode('day')">
              {{ "page.timetable.day" | translate }}
            </ion-button>
          </ion-col>
        </ion-row>
      </div>

      <div align="center">
        <ion-row>
          <ion-col size="2">
            <ion-button fill="clear" (click)="swipePrevious()"><ion-icon slot="icon-only" name="arrow-dropleft"></ion-icon></ion-button>
          </ion-col>
          <ion-col size="8">
            <h6 id="title">{{ currentTitle }}</h6>
          </ion-col>
          <ion-col size="2">
            <ion-button fill="clear" (click)="swipeNext()"><ion-icon slot="icon-only" name="arrow-dropright"></ion-icon></ion-button>
          </ion-col>
        </ion-row>
      </div>

      <!-- custom template for event in weekview -->
      <ng-template #templateWeekViewEvent let-displayEvent="displayEvent">
        <div class="calendar-event-inner" [style]="getColor(displayEvent)">
          <span *ngIf="!isMobile" class="eventTitle">{{ displayEvent.event.title }}</span>
          <span *ngIf="isMobile" class="eventTitle">{{ displayEvent.event.title.charAt(0) }}</span>
        </div>
      </ng-template>

      <!-- custom template for event in dayview -->
      <ng-template #templateDayViewEvent let-displayEvent="displayEvent">
        <div class="calendar-event-inner" [style]="getColor(displayEvent)">
          <span class="eventTitle">{{displayEvent.event.title}}</span>
        </div>
      </ng-template>

      <calendar class="calendar" [eventSource]="eventSource"
        [calendarMode]="calendarOptions.calendarMode"
        [currentDate]="calendarOptions.currentDate"
        [locale]="calendarOptions.locale"
        [startingDayWeek]="calendarOptions.startingDayWeek"
        [startingDayMonth]="calendarOptions.startingDayMonth"
        [startHour]="calendarOptions.startHour"
        [endHour]="calendarOptions.endHour"
        [step]="calendarOptions.step"
        [timeInterval]="calendarOptions.timeInterval"
        [lockSwipeToPrev]="calendarOptions.lockSwipeToPrev"
        [dateFormatter]="calendarOptions.dateFormatter"
        [showEventDetail]="calendarOptions.showEventDetail"
        [autoSelect]="calendarOptions.autoSelect"
        (onTimeSelected)="timeSelected($event)"
        (onEventSelected)="eventSelected($event)"
        (onTitleChanged)="titleChanged($event)"
        [dayviewNormalEventTemplate]="templateDayViewEvent"
        [weekviewNormalEventTemplate]="templateWeekViewEvent">
      </calendar>
  </span>

</ion-content>
